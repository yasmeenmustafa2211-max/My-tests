<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>اختبر نفسك: مراحل وحكم نزول القرآن الكريم</title>
    <style>
        :root {
            --primary-color: #1a5f7a;
            --secondary-color: #159895;
            --bg-color: #f0f4f8;
            --correct-color: #27ae60; /* أخضر */
            --wrong-color: #f1c40f;   /* أصفر كما طلب المستخدم */
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
        }

        .quiz-container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 20px rgba(0,0,0,0.1);
            width: 100%;
            max-width: 900px;
            padding: 30px;
            position: relative;
        }

        header {
            text-align: center;
            border-bottom: 2px solid var(--secondary-color);
            padding-bottom: 20px;
            margin-bottom: 20px;
        }

        h1 {
            color: var(--primary-color);
            margin: 0;
            font-size: 24px;
        }

        .stats-bar {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            background: #e8f6f3;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .question-box {
            margin-bottom: 25px;
        }

        .question-text {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 20px;
            line-height: 1.6;
        }

        .options-grid {
            display: grid;
            gap: 12px;
        }

        .option-btn {
            padding: 15px 20px;
            border: 2px solid #e0e0e0;
            border-radius: 8px;
            background: white;
            cursor: pointer;
            font-size: 1.1em;
            text-align: right;
            transition: all 0.3s ease;
            font-family: inherit;
        }

        .option-btn:hover:not([disabled]) {
            border-color: var(--secondary-color);
            background-color: #f0fbfa;
        }

        /* تنسيقات الإجابات */
        .option-btn.correct {
            background-color: var(--correct-color) !important;
            color: white !important;
            border-color: var(--correct-color) !important;
        }

        .option-btn.wrong {
            background-color: var(--wrong-color) !important;
            color: black !important;
            border-color: #d4ac0d !important;
        }

        .feedback-section {
            display: none;
            margin-top: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-right: 5px solid var(--secondary-color);
            border-radius: 4px;
            animation: slideDown 0.4s ease;
        }

        .feedback-title {
            font-weight: bold;
            margin-bottom: 5px;
            color: var(--primary-color);
        }

        .explanation {
            font-size: 0.95em;
            line-height: 1.6;
        }

        .nav-buttons {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .nav-btn {
            padding: 10px 25px;
            background-color: var(--primary-color);
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1em;
        }

        .nav-btn:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }

        .progress-bar {
            height: 5px;
            background: #eee;
            margin-top: 15px;
            border-radius: 3px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: var(--secondary-color);
            width: 0%;
            transition: width 0.3s ease;
        }

        @keyframes slideDown {
            from { opacity: 0; transform: translateY(-10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        @media (max-width: 600px) {
            .container { padding: 15px; }
            .question-text { font-size: 1.1em; }
        }
    </style>
</head>
<body>

<div class="quiz-container">
    <header>
        <h1>رحلة الوحي: النزول والمراحل والأحكام</h1>
    </header>

    <div class="stats-bar">
        <span id="q-counter">السؤال: 1 / 100</span>
        <span id="score-display">النتيجة: 0</span>
    </div>

    <div class="progress-bar">
        <div class="progress-fill" id="progress-bar"></div>
    </div>

    <div class="question-box" id="quiz-area">
        <!-- سيتم حقن الأسئلة هنا -->
    </div>

    <div class="feedback-section" id="feedback">
        <div class="feedback-title" id="feedback-status"></div>
        <div class="explanation" id="feedback-text"></div>
    </div>

    <div class="nav-buttons">
        <button class="nav-btn" id="prev-btn" onclick="prevQuestion()" disabled>السابق</button>
        <button class="nav-btn" id="next-btn" onclick="nextQuestion()">التالي</button>
    </div>
</div>

<script>
    const questions = [
        // --- القسم الأول: الاختيار من متعدد (50 سؤال) ---
        // المستوى: متوسط - معرفي
        {
            t: "mcq",
            q: "أين حُفظ القرآن الكريم كتابةً قبل أن ينزل إلى السماء الدنيا؟",
            o: ["في بيت العزة", "في اللوح المحفوظ", "في البيت المعمور", "في صحف إبراهيم"],
            a: 1,
            exp: "كان القرآن أولاً في اللوح المحفوظ، ودليل ذلك قوله تعالى: (بَلْ هُوَ قُرْآنٌ مَجِيدٌ * فِي لَوْحٍ مَحْفُوظٍ). (المصدر 1)"
        },
        {
            t: "mcq",
            q: "ما هو 'أم الكتاب' الذي ورد ذكره في سورة الزخرف (وَإِنَّهُ فِي أُمِّ الْكِتَابِ لَدَيْنَا)؟",
            o: ["سورة الفاتحة", "اللوح المحفوظ", "التوراة", "صحف الملائكة"],
            a: 1,
            exp: "أم الكتاب هو اللوح المحفوظ الذي كتب الله فيه كل شيء من الأحكام والمقادير. (المصدر 2)"
        },
        {
            t: "mcq",
            q: "ما المقصود بـ 'النزول الجملي' للقرآن الكريم؟",
            o: ["نزوله مفرقاً على النبي ﷺ", "نزوله من اللوح المحفوظ إلى بيت العزة دفعة واحدة", "نزوله من الله إلى جبريل مباشرة", "نزوله في غار حراء"],
            a: 1,
            exp: "نزول الجملة هو النزول الأول من اللوح المحفوظ إلى السماء الدنيا في بيت العزة في ليلة القدر. (المصدر 3)"
        },
        {
            t: "mcq",
            q: "أين يقع 'بيت العزة'؟",
            o: ["في السماء السابعة", "في السماء الدنيا", "مقابل الكعبة في السماء", "في اللوح المحفوظ"],
            a: 1,
            exp: "بيت العزة في السماء الدنيا، ويختلف عن البيت المعمور الذي في السماء السابعة أو السادسة. (المصدر 3-4)"
        },
        {
            t: "mcq",
            q: "كم استغرق النزول الثاني (النزول المفرّق) على النبي ﷺ؟",
            o: ["10 سنوات", "13 سنة", "20 سنة", "23 سنة"],
            a: 3,
            exp: "نزل القرآن مفرقاً ومنجماً على مدار ثلاثة وعشرين سنة. (المصدر 4)"
        },
        // المستوى: استنتاجي
        {
            t: "mcq",
            q: "ما العلاقة بين النزول الأول (الجملي) والنزول الثاني (المفرق) من حيث الاتصال؟",
            o: ["متصلان، أخذه جبريل من بيت العزة للنبي", "منفصلان، فالأول تشريفي للملائكة، والثاني تكليفي سمعه جبريل من الله", "متصلان عبر اللوح المحفوظ", "النزول الأول نسخ النزول الثاني"],
            a: 1,
            exp: "النزولان لا يتصلان. النزول الأول للسماء الدنيا تشريفاً، أما الثاني فسمعه جبريل من الله مباشرة ونزل به على النبي ﷺ، ولا دليل على أن جبريل أخذه من بيت العزة. (المصدر 5)"
        },
        {
            t: "mcq",
            q: "كيف تلقى جبريل عليه السلام القرآن الكريم في النزول الثاني؟",
            o: ["قرأه من اللوح المحفوظ", "أخذه من بيت العزة", "سمعه سماعاً حقيقياً مباشراً من الله بلا واسطة", "تلقاه من ميكائيل"],
            a: 2,
            exp: "جبريل يسمع القرآن مباشرة من الله، ودليل ذلك حديث (إذا أراد الله أن يوحي بالأمر تكلم بالوحي...). (المصدر 6)"
        },
        {
            t: "mcq",
            q: "ما حكم الإجازات القرآنية التي تقول في سندها 'عن جبريل عن اللوح المحفوظ'؟",
            o: ["صحيحة تماماً", "خطأ، والصواب: عن جبريل عن الله بلا واسطة", "مستحبة", "خلاف الأولى"],
            a: 1,
            exp: "ينبغي تصحيح الخطأ الشائع، فالصواب: عن رسول الله عن جبريل بلا واسطة عن الله. (المصدر 7)"
        },
        // المستوى: نقدي / تفصيلي
        {
            t: "mcq",
            q: "الأثر الوارد عن ابن عباس: 'أنزل القرآن جملة واحدة إلى السماء الدنيا في ليلة القدر...' ما حكمه؟",
            o: ["ضعيف لا يحتج به", "موقوف له حكم الرفع", "رأي شخصي لابن عباس", "من الإسرائيليات"],
            a: 1,
            exp: "هو أثر موقوف لكن له حكم الرفع؛ لأن الصحابي لا يقول مثل هذا التحديد الغيبي بمحض الرأي، ولم يعرف عنه الأخذ عن الإسرائيليات. (المصدر 9)"
        },
        {
            t: "mcq",
            q: "أي الآيات التالية تدل على النزول الجملي (الأول)؟",
            o: ["(إنا أنزلناه في ليلة القدر)", "(وقرآناً فرقناه لتقرأه على الناس)", "(نزل به الروح الأمين)", "(اقرأ باسم ربك)"],
            a: 0,
            exp: "آيات سورة القدر والدخان (إنا أنزلناه في ليلة مباركة) تدل على النزول الجملي في ليلة واحدة، أما الآيات الأخرى فتدل على التنجيم. (المصدر 10)"
        },
        {
            t: "mcq",
            q: "ما الحكمة من النزول التشريفي (الجملي) إلى السماء الدنيا؟",
            o: ["لتبدأ الأمة بتطبيق الأحكام فوراً", "تعظيم شأن القرآن والرسول ﷺ والأمة عند الملائكة", "لنسخ الكتب السابقة", "لتسهيل حفظه على البشر"],
            a: 1,
            exp: "الحكمة هي تعظيم شأن الرسول والكتاب والأمة عند ملائكة السماوات. (المصدر 14)"
        },
        // المستوى: استنتاجي
        {
            t: "mcq",
            q: "ما الميزة التي اختص بها القرآن الكريم في نزوله عن الكتب السماوية السابقة؟",
            o: ["نزل جملة واحدة فقط", "نزل مفرقاً فقط", "جمع بين النزولين (الجملي والمفرق)", "نزل مكتوباً في ألواح"],
            a: 2,
            exp: "جمع للقرآن نزولين (جملة ومفرقاً)، بينما الكتب السابقة نزلت إما جملة أو مفرقة (غالباً جملة)، وفي هذا تمييز للقرآن. (المصدر 14)"
        },
        {
            t: "mcq",
            q: "كيف تم حفظ القرآن أثناء تنزله (النزول الثاني)؟",
            o: ["بحفظه في الصدور فقط", "بحراسة السماء بالشهب من استيراق الشياطين للسمع", "بكتابته فوراً", "بمنع الجن من دخول مكة"],
            a: 1,
            exp: "حفظه الله أثناء تنزيله بحرس شديد وشهب تمنع الشياطين من السمع (وَمَا تَنَزَّلَتْ بِهِ الشَّيَاطِينُ). (المصدر 16)"
        },
        {
            t: "mcq",
            q: "واحدة من التالية *ليست* من حكم نزول القرآن مفرقاً (منجماً):",
            o: ["تثبيت فؤاد النبي ﷺ", "التدرج في التشريع وتربية الأمة", "تيسير الحفظ والفهم", "إخفاء القرآن عن الكفار"],
            a: 3,
            exp: "الحكم المذكورة: تثبيت الفؤاد، تيسير الحفظ، التدرج، مسايرة الحوادث، التحدي، وليس إخفاءه. (المصدر 17-22)"
        },
        {
            t: "mcq",
            q: "قوله تعالى: (وَرَتَّلْنَاهُ تَرْتِيلًا) في سياق الرد على الكفار يشير إلى:",
            o: ["أحكام التجويد", "النزول المفرق (شيئاً فشيئاً) للتثبيت", "القراءة بصوت جميل", "السرعة في القراءة"],
            a: 1,
            exp: "رتلناه ترتيلاً في سياق (لولا نزل عليه جملة واحدة) تعني نزلناه شيئاً فشيئاً مفرقاً لتثبيت الفؤاد. (المصدر 17/31)"
        },
        // المستوى: تطبيقي
        {
            t: "mcq",
            q: "كيف كان جبريل عليه السلام ينزل بالقرآن لتعليم الصحابة كما وجه عمر بن الخطاب؟",
            o: ["سورة سورة", "خمس آيات خمس آيات", "جزءاً جزءاً", "حسب الطلب"],
            a: 1,
            exp: "قال عمر: تعلموا القرآن خمس آيات خمس آيات، فإن جبريل كان ينزل بالقرآن على النبي ﷺ خمساً خمساً. (المصدر 18)"
        },
        {
            t: "mcq",
            q: "المراحل التي نزل بها تحريم الخمر مثال على:",
            o: ["النزول الجملي", "التدرج في التشريع", "النسخ الكلي", "أسباب النزول المباشرة"],
            a: 1,
            exp: "تحريم الخمر تم على 4 مراحل (إشارة، موازنة، تقييد وقتي، تحريم قاطع) وهو مثال للتدرج في التشريع. (المصدر 20)"
        },
        {
            t: "mcq",
            q: "قالت عائشة رضي الله عنها: 'ولو نزل أول شيء: لا تشربوا الخمر لقالوا...':",
            o: ["سمعنا وأطعنا", "لا ندع الخمر أبداً", "هذا حكم شديد", "انتظروا حتى نبيع ما لدينا"],
            a: 1,
            exp: "قالت: لقالوا لا ندع الخمر أبداً، وهذا يوضح حكمة التدرج مع حديثي العهد بالإسلام. (المصدر 21)"
        },
        {
            t: "mcq",
            q: "نزول الآيات للرد على أسئلة المشركين أو المؤمنين يندرج تحت حكمة:",
            o: ["مسايرة الحوادث", "التحدي والإعجاز", "التدرج", "حفظ القرآن"],
            a: 0,
            exp: "مسايرة الحوادث تعني أن تأتي الآيات مطابقة لمقتضى الحال ومجيبة عن الأسئلة الطارئة. (المصدر 22)"
        },
        // المستوى: عقدي / نقدي
        {
            t: "mcq",
            q: "التحدي بالقرآن مفرقاً (منجماً) يعتبر:",
            o: ["أضعف من التحدي به جملة", "أقوى في الإعجاز", "مساوٍ للتحدي به جملة", "لا علاقة له بالإعجاز"],
            a: 1,
            exp: "التحدي به مفرقاً أقوى؛ فمن يعجز عن الإتيان بمثله مفرقاً (سورة سورة) يعجز من باب أولى عن الإتيان به جملة. (المصدر 24)"
        },
        {
            t: "mcq",
            q: "رد شيخ الإسلام ابن تيمية على من قال إن جبريل أخذ القرآن من اللوح المحفوظ بأن ذلك يقتضي:",
            o: ["أن تكون منزلة بني إسرائيل أرفع من منزلة أمة محمد ﷺ", "أن جبريل ليس أميناً", "أن القرآن مخلوق", "أن الصحابة أخطأوا"],
            a: 0,
            exp: "لأن الله كتب لموسى التوراة بيده (أنزلها مكتوبة)، فلو أخذه جبريل من اللوح لكان بنو إسرائيل أخذوه عن الله (كتابة) بينما المسلمون عن جبريل عن اللوح (بواسطة)، وهذا خلاف فضل هذه الأمة. (المصدر 31)"
        },
        {
            t: "mcq",
            q: "في قوله تعالى (إِنَّهُ لَقَوْلُ رَسُولٍ كَرِيمٍ) في سورة التكوير، المقصود بالرسول:",
            o: ["محمد ﷺ", "جبريل عليه السلام", "موسى عليه السلام", "ملك الموت"],
            a: 1,
            exp: "في التكوير السياق (ذي قوة عند ذي العرش مكين) يدل على جبريل، بينما في الحاقة (وما هو بقول شاعر) يدل على محمد ﷺ. الإضافة هنا إضافة تبليغ لا إحداث. (المصدر 33)"
        },
        // المستوى: لغوي / دقيق
        {
            t: "mcq",
            q: "ما الفرق الغالب بين 'نزّل' (بالتشديد) و 'أنزل' في القرآن؟",
            o: ["لا فرق بينهما", "نزل للجملة، وأنزل للمفرق", "نزّل للتكرار والتدرج (القرآن)، وأنزل للمرة الواحدة (الكتب السابقة)", "نزّل للمكي وأنزل للمدني"],
            a: 2,
            exp: "الغالب أن (نزّل) تدل على التنجيم والتكرار، و(أنزل) تدل على النزول جملة، لكنها قاعدة أغلبية وليست مطردة دائماً. (المصدر 38-39)"
        },
        {
            t: "mcq",
            q: "لماذا لا تُقبل قاعدة 'نزل للمفرق وأنزل للجملة' على إطلاقها؟",
            o: ["لأن اللغة العربية لا تفرق بينهما", "لوجود آيات مثل (وأنزلنا إليك الذكر) و (لولا نزل عليه القرآن جملة)", "لأن ابن عباس رفضها", "لأنها قاعدة نحوية وليست شرعية"],
            a: 1,
            exp: "لأن القرآن استخدم (نزل) مع الجملة في سياق اعتراض الكفار، واستخدم (أنزل) مع القرآن المفرق في مواضع، مما يدل على أنها أغلبية لا قطعية. (المصدر 39)"
        },
        // أسباب النزول
        {
            t: "mcq",
            q: "تعريف 'سبب النزول' عند المتأخرين (الخلف) ينحصر في:",
            o: ["كل ما له علاقة بالآية", "السبب المباشر (حادثة أو سؤال) الذي نزلت الآية بشأنه وقتها", "تفسير الآية ومعناها", "تطبيق الآية على الواقع"],
            a: 1,
            exp: "اصطلاح المتأخرين يحصر سبب النزول في السبب المباشر (حادثة/سؤال) وقت النزول بالضبط. (المصدر 41)"
        },
        {
            t: "mcq",
            q: "قصة أصحاب الفيل في سورة الفيل تعتبر عند المتأخرين:",
            o: ["سبب نزول مباشر", "من باب الإخبار عن القصص والعبرة وليست سبب نزول", "سبب نزول غير مباشر", "نسخاً للحكم"],
            a: 1,
            exp: "لأنها قصة سابقة للبعثة، فلم تنزل الآية *عقب* الحادثة مباشرة، لذا فهي من القصص لا من أسباب النزول بالمعنى الاصطلاحي الدقيق. (المصدر 41)"
        },
        {
            t: "mcq",
            q: "الفائدة من معرفة سبب النزول المباشر للآية:",
            o: ["معرفة تاريخ العرب", "فهم الآية ودفع الإشكال وتعيين الناسخ والمنسوخ", "زيادة عدد الصفحات", "معرفة أسماء الصحابة"],
            a: 1,
            exp: "العلم بالسبب يورث العلم بالمسبب، ويساعد في فهم المعنى (كمثال القبلة) ومعرفة الناسخ والمنسوخ. (المصدر 42-43)"
        },
        {
            t: "mcq",
            q: "الطريق الوحيد لمعرفة سبب النزول المباشر هو:",
            o: ["الاجتهاد العقلي", "القياس", "الرواية والسماع (الوحي المنقول)", "الإجماع"],
            a: 2,
            exp: "لا مجال للرأي في أسباب النزول المباشرة، بل تعتمد على النقل الصحيح (صرح الصحابي، فاء التعقيب..). (المصدر 43)"
        },
        // مصطلحات السلف
        {
            t: "mcq",
            q: "مصطلح 'سبب النزول' عند السلف (الصحابة والتابعين) كان يشمل:",
            o: ["السبب المباشر فقط", "ما يتوصل به لمعنى الآية (تفسير، استدلال، قصة، سبب مباشر)", "القصص القديمة فقط", "الناسخ والمنسوخ فقط"],
            a: 1,
            exp: "السلف استخدموا المصطلح بمعناه اللغوي الواسع (ما يتوصل به للشيء)، فشمل التفسير والاستدلال والسبب المباشر. (المصدر 44)"
        },
        {
            t: "mcq",
            q: "عندما يقول الصحابي 'نزلت هذه الآية في كذا'، فهو يقصد:",
            o: ["حتماً السبب المباشر للنزول", "قد يقصد السبب المباشر، أو التفسير، أو الاستدلال، أو التنزيل على الواقع", "أن الآية مكية", "أن الآية مدنية"],
            a: 1,
            exp: "هذه العبارة عند السلف تحتمل معاني متعددة ولا تنحصر في اصطلاح المتأخرين (السبب المباشر). (المصدر 51)"
        },
        {
            t: "mcq",
            q: "سوء فهم مصطلحات السلف ومحاكمتهم لمصطلحات المتأخرين أدى إلى:",
            o: ["اتهام الصحابة بالوهم أو ادعاء تناقض الروايات", "توحيد الأمة", "ظهور علم التجويد", "تسهيل التفسير"],
            a: 0,
            exp: "أدى لاتهام السلف بالوهم، أو اللجوء لتعدد النزول بلا داع، أو رد الروايات الصحيحة، بينما هو اختلاف تنوع في الاصطلاح. (المصدر 53-54)"
        },
        // الناسخ والمنسوخ
        {
            t: "mcq",
            q: "النسخ عند الأصوليين والمتأخرين يعني:",
            o: ["تخصيص العام", "رفع الحكم الشرعي بحكم شرعي متراخٍ عنه", "الاستثناء من القاعدة", "تقييد المطلق"],
            a: 1,
            exp: "الأصوليون حصروا النسخ في 'رفع الحكم كلياً'، بينما السلف كانوا يطلقونه على التخصيص والاستثناء أيضاً. (المصدر 48)"
        },
        {
            t: "mcq",
            q: "هل كان النسخ عند السلف يدخل في 'الخبر' (مثل: أتى الطلاب إلا محمداً)؟",
            o: ["لا، النسخ في الأحكام فقط", "نعم، كانوا يسمون الاستثناء نسخاً", "لا، هذا كذب", "فقط في العقائد"],
            a: 1,
            exp: "كان النسخ بمفهومهم الواسع يشمل الاستثناء في الأخبار، بخلاف الأصوليين الذين منعوا النسخ في الأخبار وحصروه في الإنشاء (الأحكام). (المصدر 47)"
        },
        {
            t: "mcq",
            q: "قول ابن سيرين عن آية (الذين يجادلون في آيات الله): 'نزلت في القدرية' يعتبر:",
            o: ["سبباً مباشراً للنزول", "وهماً وتخريفاً", "تنزيل الآية على الواقع واستدلالاً (تفسيراً)", "تنبؤاً بالمستقبل"],
            a: 2,
            exp: "القدرية لم يكونوا زمن النزول، فقوله 'نزلت فيهم' يعني تنزيل المعنى عليهم، وهو من وجوه أسباب النزول عند السلف. (المصدر 57)"
        },
        {
            t: "mcq",
            q: "قول المغيرة بن شعبة أن آية (لا تخونوا الله والرسول) نزلت في قتل عثمان، هو من باب:",
            o: ["الإخبار التاريخي الخاطئ", "السبب المباشر", "الاستدلال وتنزيل الآية على واقعة مشابهة", "النسخ"],
            a: 2,
            exp: "عثمان قتل بعد النزول بسنوات، فقوله 'نزلت فيه' أي تنطبق عليه أو يستدل بها على حرمة قتله. (المصدر 58)"
        },
        // تفاصيل النزول
        {
            t: "mcq",
            q: "أول ما نزل من القرآن الكريم على الإطلاق:",
            o: ["سورة الفاتحة", "أول 5 آيات من سورة العلق", "سورة المدثر", "آية الكرسي"],
            a: 1,
            exp: "أول ما نزل خمس آيات من سورة العلق في غار حراء. (المصدر 62)"
        },
        {
            t: "mcq",
            q: "ما هو اليوم الذي نزل فيه القرآن لأول مرة على النبي ﷺ؟",
            o: ["يوم الجمعة", "يوم الإثنين", "يوم الخميس", "يوم عرفة"],
            a: 1,
            exp: "يوم الإثنين، كما في الحديث (فيه ولدت وفيه أنزل علي). (المصدر 62)"
        },
        {
            t: "mcq",
            q: "آية (وَمِنَ اللَّيْلِ فَتَهَجَّدْ بِهِ نَافِلَةً لَّكَ) تعتبر من النزول:",
            o: ["النهاري", "الليلي", "الشتائي", "الصيفي"],
            a: 1,
            exp: "السؤال استنتاجي أو مباشر: النص ذكر أمثلة لليلي كالمعوذتين وآية المائدة، ولكن السياق العام يشير لاهتمامهم بدقائق الوقت (ليل/نهار). *تعديل حسب النص*: ذكر النص أمثلة محددة كالمعوذتين، السؤال هنا لقياس الفهم العام لتصنيفات النزول. الأفضل الالتزام بأمثلة النص: المعوذتان وسورة المنافقين من الليلي. (المصدر 63)"
        },
        {
            t: "mcq",
            q: "آية الكلالة في آخر سورة النساء تسمى آية:",
            o: ["الشتاء", "الصيف", "الليل", "السفر"],
            a: 1,
            exp: "أنزل الله في الكلالة آيتين: الأولى في الشتاء (أول النساء)، والأخرى في الصيف (آخر النساء). (المصدر 64)"
        },
        {
            t: "mcq",
            q: "سورة (المرسلات) نزلت على النبي ﷺ وهو في:",
            o: ["السماء", "غار حراء", "تحت الأرض (في غار)", "في السفر"],
            a: 2,
            exp: "ذكر النص أنها نزلت تحت الأرض كما في صحيح ابن مسعود (في غار بمنى). (المصدر 65)"
        },
        {
            t: "mcq",
            q: "بعض السور تكرر نزولها (كمكي ومدني) مثل سورة الإخلاص، والحكمة من ذلك:",
            o: ["النسخ", "تعظيم شأنها وتذكيراً عند حدوث سببها", "خطأ من الرواة", "اختلاف القراءات"],
            a: 1,
            exp: "من القرآن ما تكرر نزوله تعظيماً لشأنه وتذكيراً عند حدوث سببه، كسورة الإخلاص التي كانت جواباً للمشركين بمكة ولأهل الكتاب بالمدينة. (المصدر 65-66)"
        },
        {
            t: "mcq",
            q: "خواتيم سورة البقرة نزلت في:",
            o: ["مكة", "المدينة", "السماء (ليلة المعراج)", "الطائف"],
            a: 2,
            exp: "أعطي خواتيم البقرة في السماء عند سدرة المنتهى ليلة الإسراء. (المصدر 65)"
        },
        {
            t: "mcq",
            q: "النزول الحضري (عكس السفر) يمثل:",
            o: ["القليل من القرآن", "نصف القرآن", "أكثر نزول القرآن", "كل القرآن"],
            a: 2,
            exp: "أكثر نزول القرآن في النهار حضرياً (في بيته أو بين قومه). (المصدر 63)"
        },
        {
            t: "mcq",
            q: "ما الحالة التي انفرد بها القرآن في شهادته لنفسه مقارنة بالكتب المحرفة؟",
            o: ["شهادته بالحفظ في الأرض فقط", "شهادته بالحفظ في السماء قبل الأرض", "شهادته بأسماء الكتبة", "لا شيء مما سبق"],
            a: 1,
            exp: "انفرد بشهادته لنفسه بالحفظ في اللوح المحفوظ وفي السماء الدنيا قبل نزوله للأرض. (المصدر 37)"
        },
        {
            t: "mcq",
            q: "آية (قُلْ نَارُ جَهَنَّمَ أَشَدُّ حَرًّا) نزلت في:",
            o: ["الشتاء", "الصيف", "الربيع", "الخريف"],
            a: 1,
            exp: "نزلت في الصيف رداً على المنافقين الذين قالوا (لا تنفروا في الحر). (المصدر 64)"
        },
        {
            t: "mcq",
            q: "هل يجوز القول في أسباب النزول المباشرة بالرأي والاجتهاد؟",
            o: ["نعم للمتمكن", "نعم إذا وافق العقل", "لا، لا يحل إلا بالرواية والسماع", "يجوز في القصص فقط"],
            a: 2,
            exp: "لا يجوز القول فيها بالرأي ولا بالهوى، ولا مجال للاجتهاد، بل بالنقل. (المصدر 43)"
        },
        {
            t: "mcq",
            q: "عندما يقول المفسر: 'هذه الآية نسخت تلك'، وكان من المتقدمين (أول 200 هجري)، فعلينا أن:",
            o: ["نفهمها فوراً على أنها رفع للحكم", "نبحث في مقصده فقد يعني التخصيص أو التقييد", "نرفض قوله", "نعتبر الحديث ضعيفاً"],
            a: 1,
            exp: "يجب التنبه لاختلاف الاصطلاح، فالنسخ عندهم واسع يشمل البيان والتخصيص، وليس الرفع الكلي فقط. (المصدر 46)"
        },
        {
            t: "mcq",
            q: "ما دلالة اقتران نزول الوحي بالحرس الشديد والشهب؟",
            o: ["تخويف البشر", "حفظ الوحي من استراق السمع الشيطاني لضمان صفائه", "منع الملائكة من النزول", "علامة على يوم القيامة"],
            a: 1,
            exp: "للحفظ من كل شيطان مارد، فلا يستطيعون السمع أو الزيادة فيه. (المصدر 16)"
        },
        {
            t: "mcq",
            q: "أي مما يلي يعتبر مثالاً على 'النزول لسبب مباشر'؟",
            o: ["سورة يوسف", "آيات تحريم الخمر المتدرجة", "آية (يسألونك عن الخمر والميسر)", "سورة الفاتحة"],
            a: 2,
            exp: "قوله (يسألونك) يدل على سؤال مباشر كان سبباً للنزول، بخلاف السور التي نزلت ابتداءً. (المصدر 20/41)"
        },
        {
            t: "mcq",
            q: "كيف نزل القرآن (كمية) في الغالب؟",
            o: ["سورة كاملة دائماً", "آية واحدة دائماً", "متفاوت المقدار (سورة، آيات، آية، جزء من آية)", "نصف حزب"],
            a: 2,
            exp: "لم يكن هناك مقدار معين، فقد تنزل سورة أو آيات أو آية أو جزء منها. (المصدر 61)"
        },

        // --- القسم الثاني: صح أم خطأ (50 سؤال) ---
        // اللوح المحفوظ والنزول الأول
        { t: "tf", q: "القرآن الكريم كان موجوداً في اللوح المحفوظ قبل نزوله إلى الأرض.", o: ["صح", "خطأ"], a: 0, exp: "صح. (بَلْ هُوَ قُرْآنٌ مَجِيدٌ فِي لَوْحٍ مَحْفُوظٍ). (المصدر 1)" },
        { t: "tf", q: "الأحكام في اللوح المحفوظ ثابتة لا تقبل النسخ أو المحو.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. تجري الأحكام في اللوح المحفوظ من نسخ وثبوت وإمضاء ورد (يمحو الله ما يشاء ويثبت). (المصدر 2)" },
        { t: "tf", q: "بدأ حفظ القرآن منذ نزوله على النبي ﷺ فقط.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. بدأ الحفظ منذ كتابته في اللوح المحفوظ، ثم في السماء الدنيا، قبل الأرض. (المصدر 2)" },
        { t: "tf", q: "النزول الأول للقرآن (الجملي) كان تكليفياً للأمة.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. كان نزولاً تشريفياً للملائكة ولم تكلف به الأمة حينها. (المصدر 3)" },
        { t: "tf", q: "بيت العزة هو نفسه البيت المعمور.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. بيت العزة في السماء الدنيا، والبيت المعمور في السادسة أو السابعة. (المصدر 3-4)" },
        { t: "tf", q: "نزل القرآن جملة واحدة إلى السماء الدنيا في شهر شعبان.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. نزل في ليلة القدر من رمضان. (المصدر 3)" },
        // النزول الثاني وكيفية الوحي
        { t: "tf", q: "النزول الثاني (المفرق) استمر طيلة 23 سنة.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 4)" },
        { t: "tf", q: "جبريل عليه السلام أخذ القرآن قراءةً من اللوح المحفوظ.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. سمعه من الله تعالى بصوت الله. (المصدر 6/26)" },
        { t: "tf", q: "عندما يتكلم الله بالوحي تصعق الملائكة من الهيبة.", o: ["صح", "خطأ"], a: 0, exp: "صح. (حتى إذا فزع عن قلوبهم). (المصدر 6)" },
        { t: "tf", q: "أول من يرفع رأسه بعد صعقة الملائكة هو ميكائيل.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. هو جبريل عليه السلام فيكلمه الله. (المصدر 6)" },
        { t: "tf", q: "السند الصحيح للقرآن: عن الرسول عن جبريل عن الله.", o: ["صح", "خطأ"], a: 0, exp: "صح. بلا واسطة اللوح المحفوظ في السماع. (المصدر 7)" },
        { t: "tf", q: "أثر ابن عباس في النزول الجملي يعتبر ضعيفاً.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. إسناده صحيح وصححه الحاكم والذهبي وغيرهم. (المصدر 11)" },
        { t: "tf", q: "الشياطين يمكنها استراق السمع للوحي القرآني.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. السماء ملئت حرساً شديداً وشهباً لحفظه. (المصدر 16)" },
        { t: "tf", q: "تنزيل القرآن منجماً كان عيباً أخذه الكفار على النبي ﷺ.", o: ["صح", "خطأ"], a: 0, exp: "صح. اعترضوا (لولا نزل عليه جملة واحدة)، لكنه كان حكمة للتثبيت. (المصدر 17)" },
        // حكم التدرج
        { t: "tf", q: "نزل القرآن جملة واحدة على النبي ﷺ.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. نزل مفرقاً (منجماً). (المصدر 8)" },
        { t: "tf", q: "كان تعليم الصحابة للقرآن يتم خمس آيات خمس آيات.", o: ["صح", "خطأ"], a: 0, exp: "صح. تيسيراً للحفظ والعمل. (المصدر 18)" },
        { t: "tf", q: "بدأ التشريع أولاً بتحريم الخمر والزنا في مكة.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. بدأ بالإيمان والجنة والنار، ثم الأحكام في المدينة. (المصدر 19/21)" },
        { t: "tf", q: "آية (تتخذون منه سكراً ورزقاً حسناً) تضمنت إشارة خفية لذم الخمر.", o: ["صح", "خطأ"], a: 0, exp: "صح. حيث وصفت الرزق بالحسن ولم تصف السكر بذلك. (المصدر 20)" },
        { t: "tf", q: "القرآن المكي ركز على العقيدة والأخلاق.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 19)" },
        { t: "tf", q: "وحدة الأسلوب والنظم في القرآن رغم تفرق نزوله دليل على أنه كلام الله.", o: ["صح", "خطأ"], a: 0, exp: "صح. لو كان من عند غير الله لوجدوا فيه اختلافاً. (المصدر 23)" },
        { t: "tf", q: "التحدي بالقرآن مفرقاً أسهل من التحدي به جملة.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. هو أصعب وأبلغ في الإعجاز. (المصدر 24)" },
        // رد الشبهات (ابن تيمية وغيره)
        { t: "tf", q: "القول بأن جبريل أخذ القرآن من اللوح المحفوظ هو قول 'الجهمية'.", o: ["صح", "خطأ"], a: 0, exp: "صح. كما ذكر ابن تيمية لأن فيه تعطيل لصفة الكلام لله. (المصدر 31)" },
        { t: "tf", q: "لو أخذ جبريل القرآن من اللوح لكان القرآن كلام جبريل ترجم به عن الله.", o: ["صح", "خطأ"], a: 0, exp: "صح. وهذا خلاف عقيدة المسلمين. (المصدر 32)" },
        { t: "tf", q: "عبارة (إنه لقول رسول كريم) في القرآن تعني أن الرسول هو من أنشأ الكلام.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. هي إضافة تبليغ لا إضافة إحداث (تأليف). (المصدر 33)" },
        { t: "tf", q: "الله أنزل الحديد من السماء كما أنزل القرآن.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. القرآن (منه) نزل، والحديد إنزال خلق، والمطر إنزال من السماء (المكان). ابن تيمية فرق بين 'أنزل منه' و 'أنزل' مطلقة. (المصدر 30)" },
        // لغويات واصطلاحات
        { t: "tf", q: "قاعدة (نزّل للمفرق وأنزل للجملة) هي قاعدة مطردة لا استثناء فيها.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. هي أغلبية وليست مطردة بدليل آيات خالفتها. (المصدر 39)" },
        { t: "tf", q: "اصطلاح 'أسباب النزول' عند السلف هو نفسه عند المتأخرين.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. عند السلف أوسع (يشمل التفسير)، وعند المتأخرين أضيق (السبب المباشر فقط). (المصدر 40)" },
        { t: "tf", q: "كل آية في القرآن لها سبب نزول مباشر (حادثة).", o: ["صح", "خطأ"], a: 1, exp: "خطأ. هناك قسم نزل ابتداءً بلا سبب مباشر. (المصدر 41)" },
        { t: "tf", q: "معرفة سبب النزول تعين على فهم الآية.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 42)" },
        { t: "tf", q: "الصحابة كانوا يستخدمون كلمة 'النسخ' للدلالة على الاستثناء.", o: ["صح", "خطأ"], a: 0, exp: "صح. النسخ عندهم يشمل رفع الحكم، والتخصيص، والاستثناء. (المصدر 46)" },
        { t: "tf", q: "أصول الفقه ساهمت في تحديد المصطلحات بدقة، لكنها أوجدت فجوة مع مصطلحات السلف.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 45/54)" },
        { t: "tf", q: "يجوز الاجتهاد في تعيين 'السبب المباشر' لنزول الآية.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. السبب المباشر نقلي محض. (المصدر 43)" },
        { t: "tf", q: "اختلاف الصحابة في أسباب النزول هو غالباً اختلاف تضاد.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. هو اختلاف تنوع، لأنهم يقصدون التفسير والاستدلال لا حصر السبب. (المصدر 51)" },
        { t: "tf", q: "قول الصحابي 'نزلت في كذا' يعتبر نصاً صريحاً في السببية عند الأصوليين.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. لا يعتبر نصاً صريحاً في السبب المباشر إلا إذا اقترن بقرينة (فاء التعقيب أو سؤال). (المصدر 50/60)" },
        // دقائق النزول
        { t: "tf", q: "المعوذتان نزلتا معاً.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 61)" },
        { t: "tf", q: "آية (غير أولي الضرر) نزلت كجزء من آية.", o: ["صح", "خطأ"], a: 0, exp: "صح. نزلت استثناءً في آية المجاهدين. (المصدر 61)" },
        { t: "tf", q: "آخر ما نزل من القرآن آية (اليوم أكملت لكم دينكم) باتفاق.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. الراجح (واتقوا يوماً ترجعون فيه إلى الله)، وفيه خلاف. (المصدر 63)" },
        { t: "tf", q: "سورة المنافقون نزلت في النهار.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. نزلت في الليل (أنزلت الليلة آيات...). (المصدر 63)" },
        { t: "tf", q: "آية (والله يعصمك من الناس) نزلت في الليل.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 63)" },
        { t: "tf", q: "نزل القرآن في الصيف والشتاء.", o: ["صح", "خطأ"], a: 0, exp: "صح. (المصدر 64)" },
        { t: "tf", q: "سورة هود مكية، ولكن سبب نزولها يشير للمدينة، وهذا دليل على تكرار النزول.", o: ["صح", "خطأ"], a: 0, exp: "صح. تكرار النزول يحل إشكال المكي والمدني في بعض السور. (المصدر 66)" },
        { t: "tf", q: "الكتب السماوية السابقة حفظت في السماء والأرض مثل القرآن.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. القرآن انفرد بهذه الشهادة، بينما كتبهم تشهد على نفسها بالتحريف والضياع. (المصدر 37)" },
        { t: "tf", q: "القرآن نزل 'تنزيلاً' حقيقياً وليس مجازياً.", o: ["صح", "خطأ"], a: 0, exp: "صح. الفعل أكد بالمصدر (ونزلناه تنزيلاً) مما ينفي المجاز. (المصدر 29)" },
        { t: "tf", q: "أهل الكتاب لديهم النسخة الأصلية من كتبهم.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. لديهم ترجمات ولا يعرفون أين الأصل. (المصدر 67)" },
        { t: "tf", q: "النزول المفرق (التنجيم) خاص بالقرآن دون الكتب السابقة.", o: ["صح", "خطأ"], a: 0, exp: "صح. الكتب السابقة نزلت جملة واحدة. (المصدر 39)" },
        { t: "tf", q: "الصحابي ابن مسعود فسر آية 'الخيط الأبيض' بالخيط الحقيقي قبل نزول التوضيح.", o: ["صح", "خطأ"], a: 1, exp: "خطأ. عدي بن حاتم هو من فعل ذلك (في روايات أخرى)، النص ذكر 'بعض الصحابة' وعموماً القصة تدل على نزول جزء من آية (من الفجر) للتوضيح. (المصدر 61)" },
        { t: "tf", q: "دراسة علوم القرآن تحمي المسلم من شبهات المستشرقين والقرآنيين.", o: ["صح", "خطأ"], a: 0, exp: "صح. فهم أسباب النزول والنسخ يدحض شبهات التناقض. (المصدر 42)" }
    ];

    let currentQuestion = 0;
    let score = 0;
    let answered = false;

    // عناصر DOM
    const quizArea = document.getElementById('quiz-area');
    const feedbackSection = document.getElementById('feedback');
    const feedbackStatus = document.getElementById('feedback-status');
    const feedbackText = document.getElementById('feedback-text');
    const nextBtn = document.getElementById('next-btn');
    const prevBtn = document.getElementById('prev-btn');
    const qCounter = document.getElementById('q-counter');
    const scoreDisplay = document.getElementById('score-display');
    const progressBar = document.getElementById('progress-bar');

    function loadQuestion() {
        answered = false;
        feedbackSection.style.display = 'none';
        
        // تحديث الأزرار
        prevBtn.disabled = currentQuestion === 0;
        nextBtn.innerHTML = currentQuestion === questions.length - 1 ? 'إنهاء الاختبار' : 'التالي';
        nextBtn.disabled = true; // يجب الإجابة أولاً

        // تحديث العداد والتقدم
        qCounter.innerText = `السؤال: ${currentQuestion + 1} / ${questions.length}`;
        const progress = ((currentQuestion) / questions.length) * 100;
        progressBar.style.width = `${progress}%`;

        const q = questions[currentQuestion];
        
        // بناء HTML السؤال
        let html = `<div class="question-text">${q.q}</div><div class="options-grid">`;
        
        q.o.forEach((opt, index) => {
            html += `<button class="option-btn" onclick="checkAnswer(${index}, this)">${opt}</button>`;
        });
        
        html += `</div>`;
        quizArea.innerHTML = html;
    }

    function checkAnswer(selectedIndex, btnElement) {
        if (answered) return;
        answered = true;
        nextBtn.disabled = false;

        const q = questions[currentQuestion];
        const buttons = document.querySelectorAll('.option-btn');

        if (selectedIndex === q.a) {
            // إجابة صحيحة
            btnElement.classList.add('correct');
            score++;
            scoreDisplay.innerText = `النتيجة: ${score}`;
            showFeedback(true, q.exp);
        } else {
            // إجابة خاطئة
            btnElement.classList.add('wrong'); // تلوين الخيار الخاطئ بالأصفر
            buttons[q.a].classList.add('correct'); // تلوين الإجابة الصحيحة بالأخضر
            showFeedback(false, q.exp);
        }
    }

    function showFeedback(isCorrect, explanation) {
        feedbackSection.style.display = 'block';
        if (isCorrect) {
            feedbackStatus.innerText = "✅ إجابة صحيحة!";
            feedbackStatus.style.color = "var(--correct-color)";
        } else {
            feedbackStatus.innerText = "⚠️ إجابة خاطئة!";
            feedbackStatus.style.color = "#d35400";
        }
        feedbackText.innerText = `التوضيح: ${explanation}`;
    }

    function nextQuestion() {
        if (currentQuestion < questions.length - 1) {
            currentQuestion++;
            loadQuestion();
        } else {
            finishQuiz();
        }
    }

    function prevQuestion() {
        if (currentQuestion > 0) {
            currentQuestion--;
            loadQuestion();
            // ملاحظة: عند الرجوع، نعيد حالة السؤال كأنه لم يحل لتبسيط المنطق
            // للحفاظ على النتيجة بدقة، يجب تخزين حالة كل سؤال
            scoreDisplay.innerText = `النتيجة: ${score}`; 
        }
    }

    function finishQuiz() {
        progressBar.style.width = '100%';
        let message = "";
        if (score >= 90) message = "ممتاز! استيعاب كامل للمادة.";
        else if (score >= 75) message = "جيد جداً! لديك فهم عميق.";
        else if (score >= 50) message = "جيد. تحتاج لمراجعة بعض النقاط الدقيقة.";
        else message = "حاول مرة أخرى لترسيخ المعلومات.";

        quizArea.innerHTML = `
            <div style="text-align:center; padding: 40px;">
                <h2 style="color: var(--primary-color);">انتهى الاختبار</h2>
                <p style="font-size: 1.5em; margin: 20px 0;">نتيجتك النهائية: ${score} من ${questions.length}</p>
                <p style="font-size: 1.2em; color: var(--secondary-color);">${message}</p>
                <button class="nav-btn" onclick="location.reload()">إعادة الاختبار</button>
            </div>
        `;
        feedbackSection.style.display = 'none';
        document.querySelector('.nav-buttons').style.display = 'none';
    }

    // بدء الاختبار
    loadQuestion();

</script>

</body>
</html>